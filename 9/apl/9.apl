m←{(≢⍵)(≢⊃⍵)⍴⊃,/⍵}⍎¨¨⊃⎕nget'../input.txt'1
mask←,⊃∧/(m<⊢)¨(¯1↓1⊖m⍪9)(9⍪1↓¯1⊖m)(⍉(¯1↓1⊖⍉m)⍪9)(⍉9⍪1↓¯1⊖⍉m)
+/1+(,m)/⍨mask
it←{(m<9)∧⊃⌈/⍵(¯1↓1⊖⍵⍪0)(0⍪1↓¯1⊖⍵)(⍉(¯1↓1⊖⍉⍵)⍪0)(⍉0⍪1↓¯1⊖⍉⍵)}
×/3↑{⍵[⍒⍵]}{≢⍵}⌸0~⍨,(it⍣((≢m)+≢⍉m))(≢m)(≢⍉m)⍴{(⍵@⍵),m<9}⍸mask
